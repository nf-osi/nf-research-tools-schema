{
  "pmid": "PMID:28166733",
  "title": "A machine learning classifier trained on cancer transcriptomes detects NF1 inactivation signal in glioblastoma.",
  "abstract": "BACKGROUND: We have identified molecules that exhibit synthetic lethality in cells with loss of the neurofibromin 1 (NF1) tumor suppressor gene. However, recognizing tumors that have inactivation of the NF1 tumor suppressor function is challenging because the loss may occur via mechanisms that do not involve mutation of the genomic locus. Degradation of the NF1 protein, independent of NF1 mutation status, phenocopies inactivating mutations to drive tumors in human glioma cell lines. NF1 inactivation may alter the transcriptional landscape of a tumor and allow a machine learning classifier to detect which tumors will benefit from synthetic lethal molecules. RESULTS: We developed a strategy to predict tumors with low NF1 activity and hence tumors that may respond to treatments that target cells lacking NF1. Using RNAseq data from The Cancer Genome Atlas (TCGA), we trained an ensemble of 500 logistic regression classifiers that integrates mutation status with whole transcriptomes to predict NF1 inactivation in glioblastoma (GBM). On TCGA data, the classifier detected NF1 mutated tumors (test set area under the receiver operating characteristic curve (AUROC) mean\u2009=\u20090.77, 95% quantile\u2009=\u20090.53 - 0.95) over 50 random initializations. On RNA-Seq data transformed into the space of gene expression microarrays, this method produced a classifier with similar performance (test set AUROC mean\u2009=\u20090.77, 95% quantile\u2009=\u20090.53 - 0.96). We applied our ensemble classifier trained on the transformed TCGA data to a microarray validation set of 12 samples with matched RNA and NF1 protein-level measurements. The classifier's NF1 score was associated with NF1 protein concentration in these samples. CONCLUSIONS: We demonstrate that TCGA can be used to train accurate predictors of NF1 inactivation in GBM. The ensemble classifier performed well for samples with very high or very low NF1 protein concentrations but had mixed performance in samples with intermediate NF1 concentrations. Nevertheless, high-performing and validated predictors have the potential to be paired with targeted therapies and personalized medicine.",
  "authors": "Gregory P Way; Robert J Allaway; Stephanie J Bouley; Camilo E Fadul; Yolanda Sanchez; Casey S Greene",
  "journal": "BMC genomics",
  "publicationDate": "2017-02-06",
  "doi": "10.1186/s12864-017-3519-7",
  "methods": "Methods The Cancer Genome Atlas Data used for building the classifier We downloaded RNAseq and mutation data from TCGA Pan Cancer project from the UCSC Xena data portal [ 15 ] and subset each dataset to only the GBMs [ 16 ]. The data consists of 607 GBMs; of which 291 have mutation calls, 172 have RNAseq measurements, and 149 have both RNAseq and mutation calls. Of these 149 samples, 15 have inactivating  NF1  mutations (10.1%) and were used as gold standard positives in building the classifier (Additional file  1 : Table S1). Additionally, to reduce dimensionality while avoiding unexpressed and invariant genes, we subset to the top 8,000 most variably expressed genes by median absolute deviation. We z-scored all gene expression measurements. This resulted in the final input matrix with dimension 149 samples by 8,000 genes. For use in platform independent predictions, we used Training Distribution Matching (TDM) to transform the TCGA RNAseq data to match a microarray expression distribution [ 17 ]. Since we are also aware of the  NF1  mutation status for each of the samples, we form a supervised learning task \u2013 predicting when a sample has loss of  NF1  activity. Our \u201cX\u201d matrix is formed by the RNAseq measurements for all 149 samples measured by 8,000 genes, which are the features in the model. Our \u201cy\u201d vector consist of {0, 1} elements where a 1 corresponds to a sample with an inactivating  NF1  mutation and a 0 is an  NF1  wildtype sample. The machine learning task is to find the feature weights, or gene coefficients, that best minimize our objective function. Along with these feature weights corresponding to the genes\u2019 importance in the learning task, we also output a probability estimate for each sample that they have loss of  NF1  activity. Hyperparameter optimization of the logistic regression classifier Using the GBM RNAseq data, we trained logistic regression classifiers with an elastic net penalty using stochastic gradient descent to detect tumors with NF1 inactivation. We chose a penalized regression model because it is simple to train and has easily interpretable outputs including importance scores for each gene (feature weights) associated with the downstream consequences of  NF1  loss of function and a probability for each sample that  NF1  is lost. An elastic net logistic regression model has also been successfully implemented in similar studies [ 18 \u2013 20 ]. We identified high-performing alpha and L1 mixing parameters using 5-fold cross validation ensuring balanced membership of  NF1  mutations in each fold. Briefly, alpha controls how weight penalty and the L1 mixing parameter tunes the amount of test set regularization by controlling the sparsity of the features. An L1 mixing parameter value of zero corresponds to the L2 penalty and a value of one corresponds to the L1 penalty, with L1 bringing a sparser solution. We used python 3.5.1 and Sci-kit Learn for machine learning implementations [ 21 ]. Ensemble classifier construction and application to the validation set After selecting optimal hyperparameters, we constructed 500 classifiers that would compose our ensemble model. Specifically, across 100 different random initializations, we subset the full TCGA GBM data into five folds and trained a single classifier for each training fold. We borrowed terminology from the epidemiology field to describe data partitioning. We trained our models on a \u201ctraining\u201d partition and assessed model performance on a \u201ctest\u201d partition, which refers to the held out cross-validation fold. The independent \u201cvalidation set\u201d refers to the GBM dataset generated in a different lab (see Fig.\u00a0 1a ). \n Fig. 1 Logistic regression classifier with elastic net penalty training and testing errors over 100 iterations for Training Distribution Matching (TDM) transformation of The Cancer Genome Atlas Glioblastoma RNAseq data.  a  Schematic describing the terms used for training, testing, and validating our model. We applied 5-fold cross validation to the full dataset which consists of training and testing splits in each fold. The model is then applied as an ensemble classifier on a set of in-house samples (validation set) ( b ) Receiver operating characteristic (ROC) curves for all 500 classifiers that make up the ensemble model applied to both training and testing set. Also shown is the aggregate performance of the ensemble classifier.  c  The cumulative density of area under the ROC curve (AUROC) for training and testing partitions Because of the small number of gold standard positive training examples, we were concerned about the stability of our model solutions. Therefore, we constructed an ensemble classifier from the 500 models. Specifically, we assigned each classifier a weight using the specific randomization\u2019s \u201ctest set\u201d cross-validation AUROC. Lastly, for the final  NF1  inactivation prediction, we used the mean of the weighted predictions across all iterations as the  NF1  inactivation prediction. We applied this ensemble classifier to the validation set in which NF1 protein levels were directly measured. Effect sizes and power analysis We calculated the decision function of each ensemble classifier applied to all samples in the training and testing 5-fold cross validation folds to calculate Cohen\u2019s D effect size between predicted  NF1  wildtype and  NF1  inactive samples [ 22 ]. The Cohen\u2019s D metric quantifies the difference between  NF1  wildtype and  NF1  inactive samples according to the mean classifier score and directly demonstrates how different the ensemble model predicts the two groups to be. Moreover, we were also concerned that our relatively small validation set would not provide us with enough power to observe a detectable effect in the ensemble model\u2019s final prediction. We performed a one-tailed Welch\u2019s two-sample  t -test comparing the NF1 protein concentration of our validation samples that were predicted to be either  NF1  wildtype or  NF1  deficient. Using the given sample size, Cohen\u2019s D effect size, and a significance threshold of \u03b1\u2009=\u20090.05, we calculated the power of the prediction scores on the validation set. The power analysis was two-sample, one-tailed and incorporated unequal sample sizes in each group. Validation sample acquisition Thirteen flash-frozen, de-identified GBM samples were obtained from the Maine Medical Center Biobank. Samples were received on dry ice and stored at \u221280\u00a0\u00b0C until isolation of DNA/RNA/protein. To isolate DNA, tumor fragments of approximately 20\u00a0mg in mass were harvested on an aluminum block pre-chilled on dry ice. Samples were then immediately transferred to a mortar and pestle containing a small volume of liquid nitrogen. The fragments were pulverized in the mortar and pestle, and the liquid nitrogen was allowed to evaporate. Next, samples were immediately processed with a DNA/RNA/Protein Purification Plus kit (Norgen Biotek) following the standard operating protocol for animal tissue. DNA concentration and quality were assessed using an ND-1000 (Nanodrop), a Qubit Fluorometer (Thermo Scientific), and a Fragment Analyzer (Advanced Analytical Technologies). To isolate RNA, \u221280 C tumor fragments were placed in 5\u201310 volumes of RNAlater-ICE Frozen Tissue Transition Solution (Ambion) and placed at \u221220\u00a0\u00b0C until RNA extraction with a mirVana miRNA isolation kit, without phenol, following the standard operating protocol (Thermo Scientific). Samples were homogenized using a manual homogenizer in the presence of mirVana lysis buffer. RNA concentration and quality were determined using a Qubit Fluorometer (Thermo Scientific) and a Fragment Analyzer (Advanced Analytical Technologies). To isolate protein, small tumor fragments were pulverized and lysed in approximately three volumes of ice-cold radioimmunoprecipitation assay (RIPA) buffer (150\u00a0mM sodium chloride, 1%\u00a0v/v nonidet P40, 0.5%\u00a0w/v sodium deoxycholate, 0.05%\u00a0w/v sodium dodecyl sulfate, 50\u00a0mM Tris pH\u00a08.0) containing 1\u00a0mM sodium orthovanadate, 1\u00a0mM sodium fluoride, 1\u00a0mM phenylmethylsulfonyl fluoride, and 1X protease inhibitor cocktail (0.1\u00a0\u03bcg/mL leupeptin, 100\u00a0\u03bcM benzamidine HCl, 1\u00a0\u03bcM aprotinin, 0.1\u00a0\u03bcg/mL soybean trypsin inhibitor, 0.1\u00a0\u03bcg/mL pepstatin, 0.1\u00a0\u03bcg/mL antipain). Samples were passed through a 25 5/8\u00a0g needle and subsequently sonicated on ice to promote efficient lysis and DNA shearing. After a 30\u00a0min incubation on ice, lysates were cleared by centrifuging at 16100 \u00d7 g for 20\u00a0min. HEK293T, U87-MG, and U87-MG cells treated for two hours with one micromolar bortezomib (Selleckchem) and ten micromolar MG132 (Selleckchem) were also prepared in RIPA buffer. Protein samples were stored at \u221280\u00a0\u00b0C until analysis. Cell culture U87-MG and HEK293T cells were purchased from ATCC. Cell lines were regularly passaged and were cultured in Dulbecco\u2019s Modified Eagle Medium (Corning) with 10%\u00a0v/v fetal bovine serum (Gibco) at 37\u00a0\u00b0C in 5% CO 2 . Recent data regarding the U87MG cell line published by Allen et al. suggest that the U87MG cell line distributed by ATCC is not from the same tumor as the cell line that was originally isolated in Uppsala. Transcriptome analysis comparing ATCC U87MG cell line to known tumor transcriptomes indicate that the ATCC U87MG cell line is a central nervous system tumor and is likely a glioblastoma cell line [ 23 ]. In the present study, we employ this cell line as a control representing an NF1-deficient tumor cell line. Previous studies have shown that the U87MG cell line has elevated proteasome-mediated degradation of NF1 and that this cell line required the loss of NF1 protein to promote tumorigenesis in xenograft tumor models [ 10 ]. Given that the ATCC U87MG cell line is a well-characterized and broadly-used model of NF1 deficient tumor cells [ 10 ,  24 \u2013 26 ], we propose that the use of the ATCC U87MG cell line is an appropriate control for Fig.\u00a0 2 . \n Fig. 2 Performance of our classifier on a validation set.  a  Two distinct western blots for each of our twelve samples. The controls are U87-MG, an  NF1  WT glioblastoma cell line that exhibits proteasomal degradation of the NF1 protein. U87\u2009+\u2009PI are U87-MG cells are treated with the proteasome inhibitors (PI) MG-132 and bortezomib to block proteasome-mediated degradation of NF1. We used the NF1/tubulin ratio normalized to U87\u2009+\u2009PI as our NF1 protein level estimate.  b  Prediction scores for each of the 500 classifiers weighted by cross validation test set AUROC where a negative number indicates  NF1  wildtype and a positive number is indicates NF1 inactivation. Darker shades of blue indicate higher observed NF1 protein concentrations.  c  We quantify protein against U87\u2009+\u2009PI and provide the mean of the weighted predictions.  d  Based on weighted predictions, we show the abundance of NF1 protein compared to U87\u2009+\u2009PI RNA microarray After RNA isolation and QC, samples were labeled for the GeneChip Human Transcriptome Array 2.0 (HTA 2.0, Affymetrix). Labeling was performed with Affymetrix Proprietary DNA Label (biotin-linked) using a WT Plus Kit (Affymetrix) provided with the HTA 2.0, following the standard operating protocol for HTA 2.0, including PolyA controls. Hybridization, washing, and staining were performed with the WT Plus Kit, following the standard operating protocol for HTA 2.0. Washing and staining were performed using a GeneChip Fluidics 450. Scanning was performed with a GeneChip Scanner 3000. These data were deposited in the Gene Expression Omnibus under accession  GSE85033 . Validation sample processing We applied a quality control pipeline [ 27 ] to all CEL files generated by the HTA 2.0. All validation samples passed processing quality control, which included an inspection of spatial artifacts, MA plots, probe distributions, and sample comparison boxplots. We summarized transcript intensities using robust multi-array analysis (RMA) [ 28 ]. We determined batch normalization was unnecessary after a guided principal components analysis (gPCA) using sample processing date and array plate ID as potential batch effect confounders [ 29 ]. Lastly, we collapsed HTA2.0 transcripts into gene level measurements using the \u2018collapseRows()\u2019 function with the \u201cmaxmean\u201d method from the R package WGCNA [ 30 ]. We used the pd.hta.2.0 platform design file (version 3.12.1) and the Bioconductor package \u201chta20sttranscriptcluster.db\u201d (version 8.3.1) to map manufacturer transcript IDs to genes. We performed all preprocessing steps using R version 3.2.3. Western blotting Prior to sodium dodecyl sulfate polyacrylamide gel electrophoresis, protein sample concentration was determined using a Pierce BCA Protein Assay Kit (Thermo Scientific). Protein samples were prepared with 1X Laemmli sample buffer (50\u00a0mM Tris pH\u00a06.8, 0.02%\u00a0w/v bromophenol blue, 2%\u00a0w/v SDS, 10%\u00a0v/v glycerol, 1%\u00a0v/v beta-mercaptoethanol, 12.5\u00a0mM EDTA) and 50\u00a0\u03bcg of tumor protein. Volumes were normalized with RIPA buffer including the protease/phosphatase inhibitors described above. SDS-PAGE was performed using a 4-15% Mini-PROTEAN TGX gel (Bio-Rad) for 1\u00a0h at 120\u00a0V. The samples were then transferred to a nitrocellulose membrane for 2\u00a0h and 45\u00a0min at 400\u00a0mA in cold transfer buffer (384\u00a0mM glycine, 50\u00a0mM Tris, 20% methanol, 0.005%\u00a0w/v sodium dodecyl sulfate. Following this, the blots were then blocked in 5%\u00a0w/v BSA or 5%\u00a0w/v nonfat dry milk in Tris-buffered saline (137\u00a0mM NaCl, 2.7\u00a0mM KCl, 19\u00a0mM Tris, 0.05%\u00a0v/v Tween 20, pH\u00a07.4) for 25\u00a0min. Immunoblotting was performed with the following antibodies and conditions (vendor, species, diluent, dilution, incubation time, incubation temperature): anti-NF1 D7R7D #14624 (Cell Signaling, rabbit, 2% BSA, 1:1000, overnight, 4\u00a0\u00b0C), anti-tubulin B-1-2-5 (Santa Cruz, mouse, 2% milk, 1:10000, 1\u00a0h, RT), anti-EGFR D38B1 #4267 (Cell Signaling, rabbit, 2% milk, 1:1000\u20131:2000, 1\u00a0h, RT), p-ERK \u00bd (p44/42 MAPK) #9101 (Cell Signaling, rabbit, 2% BSA, 1:2000, overnight, 4\u00a0\u00b0C), SUZ12 D39F6 #3737 (Cell Signaling, rabbit, 2% milk, 1:1000, overnight, 4\u00a0\u00b0C). Anti-NF1 D7R7D was a kind gift from Cell Signaling Technologies, Inc. The binding of the primary antibodies was detected by incubation with secondary antibodies goat anti-rabbit HRP 1:20000 or goat anti-mouse HRP 1:10000 (Jackson Immunoresearch Laboratories Inc.) at room temperature in 2% milk in TBST and detection of HRP activity using Pierce ECL Western Blotting substrate (Thermo Scientific), or in the case of  NF1 , SuperSignal West Femto Maximum Sensitivity Substrate (Thermo Scientific). The chemiluminescent signal was captured with MED-B medical x-ray film (Med X Ray Company Inc.). Between primary antibodies, the membrane was stripped twice for 10\u00a0min at room temperature using a mild stripping buffer containing 1.5%\u00a0w/v glycine, 0.1%\u00a0w/v SDS, 1%\u00a0v/v Tween 20 at pH\u00a02.2 (Abcam). One sample was eliminated due to low yield, and apparent degradation as determined by western blotting (all proteins examined were undetectable with the exception of tubulin, not shown). Densitometry was performed using Li-COR Image Studio Lite 5.0. Briefly, intensity measurements for  NF1  and tubulin were taken using equally-sized regions for all bands. The background was subtracted using the local median intensity from the left and right borders (size\u2009=\u20092) of each measurement region.  NF1  values were divided by tubulin intensity to adjust for protein loading. All measurement ratios were then normalized by dividing values by the \u201cU87\u2009+\u2009PI\u201d measurement for each blot, respectively. Reproducibility of computational analyses We provide software with a permissive open source license to reproduce all computational analyses [ 31 ]. Ensuring a stable compute environment, we performed all analyses in a Docker image [ 32 ]. This image and source code can be used to freely confirm, modify, and build upon this work. Availability of data and materials All source code is available under a permissive open source license in the nf1_inactivation GitHub repository,  https://github.com/greenelab/nf1_inactivation . We also provide a docker image to replicate the computational environment at  https://hub.docker.com/r/gregway/nf1_inactivation/ . Additionally, all validation data is available under Gene Expression Omnibus accession number  GSE85033 .",
  "cache_level": "minimal",
  "has_fulltext": true,
  "fetch_date": "2026-02-19 09:26:58"
}